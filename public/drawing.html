<html>
    <head>
        <script>
            var canvas;
            var context;
            var image;
            function init() {
                var canvas = document.getElementById("drawing");
                context = canvas.getContext("2d");
                image = new Image();
                image.onload = function () {
                    drawImage();
                };
                image.src = "sample/sample1.png";
            }

            function drawImage() {
                context.drawImage(image, 0, 0);

                context.lineWidth = 2;
                context.strokeStyle = "maroon";

                let centerX = 500,
                    centerY = 400,
                    radius = 257,
                    startArc = 0,
                    endArc = 2 * Math.PI;

                /*
                // Draw outline
                context.beginPath();
                context.arc(centerX, centerY, radius, startArc, endArc);
                context.stroke();
                radius = 127;
                context.beginPath();
                context.arc(centerX, centerY, radius, startArc, endArc);
                context.stroke();
                */

                // Calculate number of sections from image width/height ratio
                const ratio = Math.round(image.width / image.height);
                const numSection = Math.round(convertInterval(ratio, [0.5, 2], [20, 3]));

                const sectionArc = (2 * Math.PI) / numSection;
                const pixelArc = sectionArc / image.width;
                for (let s = 0; s < numSection; s++) {
                    const sectionStart = s * sectionArc;
                    for (let y = 0; y < image.height; y++) {
                        radius = 256 - y * 2;
                        for (let x = 0; x < image.width; x++) {
                            const imageData = context.getImageData(x, y, 1, 1).data;
                            context.strokeStyle =
                                "rgba(" + imageData[0] + ", " + imageData[1] + ", " + imageData[2] + ", " + imageData[3] + ")";
                            context.lineWidth = 2;
                            startArc = sectionStart + x * pixelArc;
                            endArc = startArc + pixelArc;
                            context.beginPath();
                            context.arc(centerX, centerY, radius, startArc, endArc);
                            context.stroke();
                        }
                    }
                }
            }

            function convertInterval(value, from, to) {
                if (value < from[0]) value = from[0];
                if (value > from[1]) value = from[1];
                return ((value - from[0]) * (to[0] - to[1])) / (from[1] - from[0]) + to[1];
            }
        </script>
    </head>
    <body onload="init()">
        <canvas id="drawing" width="1000" height="1000" style="width: 1000px; height: 1000px" />
    </body>
</html>
